{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>‚úèÔ∏è Modifier le Lot #{{ produit.id }}</h2>
        <span class="badge bg-info text-dark">Statut actuel : {{ produit.statut }}</span>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-body p-4">
            <form method="POST">
                <h5 class="text-success mb-3 border-bottom pb-2">üì¶ Nature du Produit</h5>
                <div class="row mb-4">
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Type de Produit</label>
                        <select name="type_id" class="form-select" required>
                            {% for t in types %}
                            <option value="{{ t.id }}" {% if t.id == produit.type_id %}selected{% endif %}>{{ t.nom }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Vari√©t√©</label>
                        <select name="variete_id" class="form-select" required>
                            {% for v in varietes %}
                            <option value="{{ v.id }}" {% if v.id == produit.variete_id %}selected{% endif %}>{{ v.nom }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Calibre</label>
                        <select name="calibre_id" class="form-select" required>
                            {% for c in calibres %}
                            <option value="{{ c.id }}" {% if c.id == produit.calibre_id %}selected{% endif %}>{{ c.nom }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <h5 class="text-success mb-3 border-bottom pb-2">‚öñÔ∏è Conditionnement & Poids</h5>
                <div class="row mb-4">
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Type de Conditionnement</label>
                        <select name="cond_id" class="form-select" required>
                            {% for co in conditionnements %}
                            <option value="{{ co.id }}" {% if co.id == produit.cond_id %}selected{% endif %}>{{ co.nom }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Nombre de Colis</label>
                        <input type="number" name="nb_unites" class="form-control" value="{{ produit.nb_unites }}" required min="1">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Poids Total (kg)</label>
                        <div class="input-group">
                            <input type="number" step="0.01" name="poids_total" class="form-control" value="{{ produit.poids_total }}" required>
                            <span class="input-group-text">kg</span>
                        </div>
                    </div>
                </div>

                <h5 class="text-success mb-3 border-bottom pb-2">üìç Provenance</h5>
                <div class="row mb-4">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Parcelle d'origine</label>
                        <select name="parcelle_id" class="form-select" required>
                            {% for p in parcelles %}
                            <option value="{{ p.id }}" {% if p.id == produit.parcelle_id %}selected{% endif %}>
                                {{ p.nom }} ({{ p.producteur_rel.nom }})
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="d-flex justify-content-end gap-2 border-top pt-3">
                    <a href="/stock" class="btn btn-light border">Annuler</a>
                    <button type="submit" class="btn btn-warning px-4">üíæ Enregistrer les modifications</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}