{% extends 'base.html' %}
{% block content %}
<h2 class="mb-4">‚öôÔ∏è Configuration du Syst√®me</h2>

<div class="accordion" id="accordionSettings">
  <div class="accordion-item shadow-sm mb-3">
    <h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#secSoc">1. Infos Soci√©t√©</button></h2>
    <div class="card shadow-sm mb-4">
      <div class="card-header bg-primary text-white">üè¢ Informations de la Soci√©t√©</div>
      <div class="card-body">
          <form method="POST" action="{{ url_for('parametres') }}">
              <input type="hidden" name="action" value="update_societe">
              
              <div class="mb-3">
                  <label class="form-label">Nom de la soci√©t√©</label>
                  <input type="text" name="nom" class="form-control" value="{{ societe.nom if societe else '' }}" required>
              </div>
              
              <div class="mb-3">
                  <label class="form-label">Adresse</label>
                  <input type="text" name="adresse" class="form-control" value="{{ societe.adresse if societe else '' }}">
              </div>
  
              <div class="row">
                  <div class="col-md-4 mb-3">
                      <label class="form-label">Code Postal</label>
                      <input type="text" name="code_postal" class="form-control" value="{{ societe.code_postal if societe else '' }}">
                  </div>
                  <div class="col-md-8 mb-3">
                      <label class="form-label">Ville</label>
                      <input type="text" name="ville" class="form-control" value="{{ societe.ville if societe else '' }}">
                  </div>
              </div>
  
              <div class="mb-3">
                  <label class="form-label">Code CoC (GlobalGap)</label>
                  <input type="text" name="coc_number" class="form-control" value="{{ societe.coc_number if societe else '' }}">
              </div>
  
              <button type="submit" class="btn btn-primary">Enregistrer les informations</button>
          </form>
      </div>
  </div>
  </div>

  <div class="accordion-item shadow-sm mb-3">
    <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#secProd">2. Producteurs et Parcelles</button></h2>
    <div id="secProd" class="accordion-collapse collapse">
      <div class="accordion-body">
        <h6>Ajouter un Producteur :</h6>
        <form method="POST" class="row g-2 mb-4">
            <input type="hidden" name="action" value="add_producteur">
            <div class="col-md-5"><input type="text" name="nom" class="form-control" placeholder="Nom" required></div>
            <div class="col-md-5"><input type="text" name="ggn" class="form-control" placeholder="GGN" required></div>
            <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">Ajouter</button></div>
        </form>
        <h6>Ajouter une Parcelle :</h6>
        <form method="POST" class="row g-2">
            <input type="hidden" name="action" value="add_parcelle">
            <div class="col-md-5"><input type="text" name="nom" class="form-control" placeholder="Nom Parcelle" required></div>
            <div class="col-md-5">
                <select name="prod_id" class="form-select">
                    {% for p in producteurs %}<option value="{{ p.id }}">{{ p.nom }}</option>{% endfor %}
                </select>
            </div>
            <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">Ajouter</button></div>
        </form>
      </div>
    </div>
  </div>

  <div class="accordion-item shadow-sm mb-3">
    <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#secTypes">3. Types de Produits et Vari√©t√©s</button></h2>
    <div id="secTypes" class="accordion-collapse collapse">
      <div class="accordion-body">
        <form method="POST" class="row g-2 mb-4 border-bottom pb-3">
            <input type="hidden" name="action" value="add_type_produit">
            <div class="col-md-9"><input type="text" name="nom" class="form-control" placeholder="Nouveau Type (ex: Tomates)" required></div>
            <div class="col-md-3"><button type="submit" class="btn btn-primary w-100">Cr√©er Type</button></div>
        </form>
        <form method="POST" class="row g-2">
            <input type="hidden" name="action" value="add_variete">
            <div class="col-md-5">
                <select name="type_id" class="form-select">
                    {% for t in types_prod %}<option value="{{ t.id }}">{{ t.nom }}</option>{% endfor %}
                </select>
            </div>
            <div class="col-md-4"><input type="text" name="nom" class="form-control" placeholder="Vari√©t√©" required></div>
            <div class="col-md-3"><button type="submit" class="btn btn-primary w-100">Ajouter Vari√©t√©</button></div>
        </form>
      </div>
    </div>
  </div>

  <div class="accordion-item shadow-sm mb-3">
    <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#secCond">4. Conditionnements</button></h2>
    <div id="secCond" class="accordion-collapse collapse">
      <div class="accordion-body">
        <form method="POST" class="row g-2">
            <input type="hidden" name="action" value="add_cond">
            <div class="col-md-5"><input type="text" name="nom" class="form-control" placeholder="Nom (ex: Sac 10kg)" required></div>
            <div class="col-md-5"><input type="number" step="0.01" name="poids" class="form-control" placeholder="Poids Unitaire (kg)" required></div>
            <div class="col-md-2"><button type="submit" class="btn btn-success w-100">Ajouter</button></div>
        </form>
      </div>
    </div>
  </div>
</div>
<div class="card p-3 mb-4 shadow-sm">
    <h5>üìè Gestion des Calibres</h5>
    <form method="POST" class="row g-2 mb-3">
        <input type="hidden" name="action" value="add_calibre">
        <div class="col-auto">
            <input type="text" name="nom" class="form-control" placeholder="ex: 40/50" required>
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-success">Ajouter</button>
        </div>
    </form>
    <table class="table table-sm">
        {% for c in calibres %}
        <tr>
            <td>{{ c.nom }}</td>
            <td class="text-end">
                <a href="{{ url_for('modifier_calibre', id=c.id) }}" class="btn btn-sm btn-outline-warning">‚úèÔ∏è</a>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>



{% endblock %}